% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/GTM.R
\name{sGTM}
\alias{sGTM}
\title{Stochastic Guided Topic Model (sGTM)}
\usage{
sGTM(
  scte,
  K,
  D,
  batch_size = 1024,
  num_threads = 1,
  maxiter = 100,
  verbal = TRUE,
  zero_gamma = FALSE,
  rand_gamma = TRUE,
  thresh = 1e-08,
  burnin = 1,
  lr = 0.1,
  shuffle = TRUE
)
}
\arguments{
\item{scte}{A `SingleCellTopicExperiment` or `SpatialTopicExperiment` object containing count data and prior matrices.}

\item{K}{Integer, the number of topics to infer.}

\item{D}{Integer, the number of cells (documents) in the dataset.}

\item{batch_size}{Integer, the number of cells per mini-batch. Default is 1024.}

\item{num_threads}{Integer, the number of threads to use for parallel computation. Default is 1.}

\item{maxiter}{Integer, the maximum number of epochs for training. Default is 100.}

\item{verbal}{Logical, whether to print progress messages. Default is TRUE.}

\item{zero_gamma}{Logical, whether to initialize gamma values to zero. Default is FALSE.}

\item{rand_gamma}{Logical, whether to initialize gamma values randomly. Default is TRUE.}

\item{thresh}{Convergence threshold based on the change in `nwk`. Default is 1e-8.}

\item{burnin}{Maximum number of iterations to run during the GTM E-step for each sample (default is 1).}

\item{lr}{Numeric, the SVI learning rate for global updates. Default is 0.1.}

\item{shuffle}{Logical, whether to shuffle cells each epoch. Default is TRUE.}
}
\value{
A `SingleCellTopicExperiment` or `SpatialTopicExperiment` object with updated topic distributions.
}
\description{
This function trains a stochastic variational inference (SVI) version of the
Guided Topic Model (GTM) using mini-batches of cells. It builds the `CellMap`
object one batch at a time to reduce memory usage during inference.
}
