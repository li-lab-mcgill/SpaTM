% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/STM.R
\name{build_mlp}
\alias{build_mlp}
\title{Build a Multi-Layer Perceptron (MLP) Model}
\usage{
build_mlp(
  layers = 1,
  d_in,
  d_hidden,
  d_out,
  device = NULL,
  dummy_topic = FALSE
)
}
\arguments{
\item{layers}{Integer indicating the number of hidden layers. Must be between 0 and 3 (default is 1).}

\item{d_in}{Integer specifying the input dimension (number of input features).}

\item{d_hidden}{A vector of integers specifying the dimensions of the hidden layers. The length of the vector determines the number of hidden layers.
For example, if `layers = 2`, `d_hidden` should have two elements (e.g., `c(64, 32)`).}

\item{d_out}{Integer specifying the output dimension (e.g., the number of classes or topics).}

\item{device}{The device on which to run the model. Defaults to `"cpu"`. Can be set to `"cuda"` for GPU acceleration if available.}

\item{dummy_topic}{Logical indicating whether to include a dummy topic in the input (default is `FALSE`).
If `TRUE`, the input dimension (`d_in`) is reduced by 1 to account for the dummy topic.}
}
\value{
An MLP model (of class `nn_module`) for the specified architecture. The model consists of sequential layers, including:
  - `nn_linear`: Linear transformations between layers.
  - `nn_relu`: ReLU activation functions.
  - `nn_softmax`: Softmax activation function applied to the output layer.
}
\description{
This function constructs a multi-layer perceptron (MLP) model with up to 3 hidden layers. The model can be used for tasks such as classification, and the number of hidden layers and their sizes are configurable.
If a dummy topic is used, the input dimension is adjusted accordingly.
}
\examples{
# Example 1: Build a 1-hidden-layer MLP with 100 input features, 50 hidden units, and 10 output units.
mlp_model <- build_mlp(layers = 1, d_in = 100, d_hidden = 50, d_out = 10)

# Example 2: Build a 2-hidden-layer MLP with 100 input features, 64 and 32 hidden units, and 10 output units.
mlp_model <- build_mlp(layers = 2, d_in = 100, d_hidden = c(64, 32), d_out = 10)

# Example 3: Build a 3-hidden-layer MLP with a dummy topic.
mlp_model <- build_mlp(layers = 3, d_in = 100, d_hidden = c(64, 32, 16), d_out = 10, dummy_topic = TRUE)

}
